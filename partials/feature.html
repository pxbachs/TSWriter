<div class="scriptWriter" >

	<div id="sidebar-wrapper" ng-controller="StepsController">

		<ul class="sidebar-nav">
			<li >
				<h3>STEPS</h3>
			</li>

			<li ng-repeat="group in steps_def">
				<div class="">
					<div class="">
						<h4 class="list-group-item"><a data-toggle="collapse" href="~/#div_{{group.id}}">{{group.name}}</a></h4>
					</div>
					<div id="div_{{group.id}}" class="panel-collapse collapse">

						<ul dnd-list="group.steps"  class="steps"
						dnd-disable-if="true">
							<li ng-repeat="step in group.steps"
							dnd-draggable="step"
							dnd-effect-allowed="copy"
							dnd-type="step.type"
							ng-class="{selected: models.selected === step}"
							>
								<div class="item">
									{{step.syntax}}
								</div>
							</li>
						</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>

	<!-- TODO feature here -->
	<div class="col-md-9"  ng-controller="FeatureController">
		<script type="text/ng-template" id="myModalContent.html">
				<div class="modal-header">
				<h4 class="modal-title">Edit Step</h4>
				</div>
				<div class="modal-body">
					<div>
					<b>Syntax:</b> <input type="text" ng-model="selectedEditStep.syntax" class="form-control input-sm"/>
					</div>
					<br/>
					<div  >
					<b>Ruby: </b><textarea rows="10" ng-model="selectedEditStep.rb" class="form-control input-sm" ng-readonly="rbCodeReadOnly"/>
					</div>
				</div>
				<div class="modal-footer">
				<button class="btn btn-primary" type="button" ng-click="ok()">OK</button>
				<button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>
				</div>
			</script>
			
			<script type="text/ng-template" id="removeStepModalContent.html">
				<div class="modal-header">
				<h4 class="modal-title">Remove Step?</h4>
				</div>
				<div class="modal-body">
					<b>Are you sure you want to remove this step: </b> {{selectedStep.syntax}}
				</div>
				<div class="modal-footer">
				<button class="btn btn-primary" type="button" ng-click="ok()">OK</button>
				<button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>
				</div>
			</script>
			
			<script type="text/ng-template" id="ImportModalContent.html">
				<div class="modal-header">
				<h4 class="modal-title">Import Content</h4>
				</div>
				<div class="modal-body">
					<b>Model Content: </b><textarea rows="15" ng-model="importContent" class="form-control input-sm"/>
				</div>
				<div class="modal-footer">
				<button class="btn btn-primary" type="button" ng-click="ok()">OK</button>
				<button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>
				</div>
			</script>
		<ul class="list-group" dnd-list="steps_def"
		dnd-allowed-types="scenarioAllowedTypes">
			<li class="panel-group" ng-repeat="group in steps_def"
			dnd-draggable="group"
			dnd-effect-allowed="move"
			dnd-moved="steps_def.splice($index, 1)"
			dnd-type="group.type"
			>
				<div class="dropzone panel panel-default">
					<div class="panel-heading">
						<h4 class="panel-title" >
							<a data-toggle="collapse" href="~/#div2_{{group.id}}" class="scenario_label">Scenario: </a>
							<div class="scenario_input">
								<input type="text" ng-model="group.name" class="form-control input-sm">
							</div>
						</h4>
					</div>
					<div id="div2_{{group.id}}" class="panel-collapse collapse in">

						<ul dnd-list="group.steps"
						dnd-allowed-types="stepAllowedTypes">
							<li ng-repeat="step in group.steps"
							dnd-draggable="step"
							dnd-type="step.type"
							dnd-effect-allowed="move"
							dnd-moved="group.steps.splice($index, 1)"
							dnd-selected="models.selected = step"
							ng-class="{selected: models.selected === step}"
							>
								<div class="item">
									<span>{{step.syntax}}</span>
									<div class="functions">
										<input type="button" class="btn btn-primary" value="Edit" ng-click="showEdit(this)"/>
										<input type="button" class="btn btn-danger" value="Remove" ng-click="remove(group.steps, $index)"/>
									</div>
								</div>
								
							</li>
							<li class="dndPlaceholder">
								Drop STEP here
							</li>
						</ul>
					</div>
				</div>
			</li>

			<li class="dndPlaceholder">
				Drop any <strong>{{scenarioAllowedTypes.join(' or ')}}</strong> here
			</li>
		</ul>
		
		<br/>
					<h3>Output</h3>
					<h5>Feature</h5>
					<pre>{{features}}</pre>
					<h5>Ruby</h5>
					<pre>{{rubyCode}}</pre>
					<br/>
					<h5>Model as Json</h5>
					<pre>{{modelAsJson}}</pre>
		<button id="savebtn" ng-click="save()" style="display: none;">Save</button>
		<button id="importbtn" ng-click="showImport()" style="display: none;">Import</button>
	</div>
	
	
	<!-- TODO toolbox here -->
	<div class="nav-right row ng-scope">
		<div>
			<button class="btn btn-warning" onclick="$('#savebtn').click();">Save</button>
			<button class="btn btn-primary" onclick="$('#importbtn').click();">Import</button>
		</div>
		<div class="toolbox box box-grey box-padding">
			<h5>New Elements</h5>
			<ul id="toolbox">
				<!-- The toolbox only allows to copy objects, not move it. After a new
				element was created, dnd-copied is invoked and we generate the next id -->
				<li ng-repeat="item in models.templates"
				dnd-draggable="item"
				dnd-effect-allowed="copy"
				dnd-type="item.type"
				dnd-copied="item.index = item.index + 1; item.id =  item.type + '-custom-' + item.index"
				>
					<div class="item">
						{{item.name}}
					</div>
				</li>
			</ul>
		</div>

		<div class="trashcan box box-grey box-padding">
			<!-- If you use [] as referenced list, the dropped elements will be lost -->
			<h5>Trashcan</h5>
			<ul dnd-list="[]">
				<li><img src="trashcan.jpg">
				</li>
			</ul>
		</div>
	</div>
</div>
